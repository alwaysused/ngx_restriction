
名称：ngx_restriction nginx访问限制模块
版本：1.0
作者：hnjiakai
公司：央视网

   工作中发现很多地方都希望既不影响正常用户访问，又想过滤掉恶意用户访问。
   
   nginx自带有两个命令一个是limit_zone，另一个是 limie_req_zone,两个都可以限制连接。
   
   我们的模块跟自带的模块相比，配置更为简洁易懂；另外加入了淘汰机制，对已经超期无用的访问记录及时淘汰，更节省内存，避免共享内存用完导致的访问错误。
   
   配置如下：
   restriction 500 10m ; 
   配置解释：
   500单位是毫秒，在500毫秒内，同一ip对一个uri只能访问一次。 
   10m，为存储访问记录的共享内存大小，主要存储ip+uri和上次访问时间。
   
   除了上面一个命令外，该模块还有另外一个命令：
   restriction_status ;
   用法：
   location /re_status {
      restriction_status ;
   }
   配置解释：该命令会输出当前共享内存中访问记录的个数，可以根据该记录判断该时段内的大致访问量。
   
   除此之外，该代码还是一个很好的学习nginx模块开发的例子。红黑树、队列、共享内存等，都有用到。
   
   虽然很愿意在开源社区奉献自己的绵薄之力，作品确很少。一个是有自己本职工作要做，时间有限，另外在各位大牛面前，颇自惭形秽。
   
   在领导马哥的鼓励之下，将代码提交，希望能抛砖引玉，不足之处敬请指正。
   
   
   
   
